<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta content="utf-8" http-equiv="encoding" />
  </head>
  <body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
      var ballX = 75;
      var ballSpeedX = 5;
      var ballY = 75;
      var ballSpeedY = 5;

      var BRICK_W = 100;
      var BRICK_H = 50;
      const BRICK_COUNT = 8;
      var brick0 = false;
      var brick1 = true;
      var brick2 = true;
      var brick3 = true;
      var brickGrid = new Array(BRICK_COUNT);

      const PADDLE_WIDTH = 100;
      const PADDLE_THICKNESS = 10;
      const PADDLE_DIST_FROM_EDGE = 60;
      var paddleX = 400;

      var canvas, canvasContext;

      var mouseX;
      var mouseY;

      function updateMousePos(evt) {
        var rect = canvas.getBoundingClientRect();
        var root = document.documentElement;

        mouseX = evt.clientX - rect.left - root.scrollLeft;
        mouseY = evt.clientY - rect.top - root.scrollTop;
        //  var mouseX = evt.clientX - rect.left - root.scrollLeft;
        paddleX = mouseX - PADDLE_WIDTH / 2;
      }

      function brickReset() {
        for (var i = 0; i < BRICK_COUNT; i++) {
          if (Math.random() < 0.5) {
            brickGrid[i] = true;
          } else {
            brickGrid[i] = false;
          }
        }
      }

      window.onload = function () {
        canvas = document.getElementById('gameCanvas');
        canvasContext = canvas.getContext('2d');

        var framePerSecon = 30;
        setInterval(updateAll, 1000 / framePerSecon);
        canvas.addEventListener('mousemove', updateMousePos);
        brickReset();
      };

      function ballReset() {
        ballX = canvas.width / 2;
        ballY = canvas.height / 2;
      }

      function updateAll() {
        moveAll();
        drawAll();
      }

      function moveAll() {
        ballX += ballSpeedX;
        if (ballX > canvas.width) {
          //right
          ballSpeedX *= -1;
        }
        if (ballX < 0) {
          //left
          ballSpeedX *= -1;
        }
        ballY += ballSpeedY;
        if (ballY > canvas.height) {
          //bottom
          ballReset();
          //   ballSpeedY *= -1;
        }
        if (ballY < 0) {
          //top
          ballSpeedY *= -1;
        }

        var paddleTopEdgeY = canvas.height - PADDLE_DIST_FROM_EDGE;
        var paddleBottomEdgeY = paddleTopEdgeY + PADDLE_THICKNESS;
        var paddleLeftEdgeX = paddleX;
        var paddleRightEdgeX = paddleLeftEdgeX + PADDLE_WIDTH;
        if (
          ballY > paddleTopEdgeY && //below the top of the paddle
          ballY < paddleBottomEdgeY && // above bottom of paddle
          ballX > paddleLeftEdgeX && // right of the left side of the paddle
          ballX < paddleRightEdgeX
        ) {
          //left of the right side of paddle

          ballSpeedY *= -1;

          var centerOfPaddleX = paddleX + PADDLE_WIDTH / 2;
          var ballDistFromPaddleCenterX = ballX - centerOfPaddleX;
          ballSpeedX = ballDistFromPaddleCenterX * 0.35;
        }
      }
      function drawBricks() {
        // if(brickGrid[0]){
        // colorRect(0,0,BRICK_W-2,BRICK_H,'blue');
        // }
        // if(brickGrid[1])
        // colorRect(BRICK_W,0,BRICK_W-2,BRICK_H, 'blue');
        // if(brickGrid[2])
        // colorRect(BRICK_W*2,0,BRICK_W-2,BRICK_H, 'blue');
        // if(brickGrid[3])
        // colorRect(BRICK_W*3,0,BRICK_W-2,BRICK_H, 'blue');

        for (var i = 0; i < BRICK_COUNT; i++) {
          if (brickGrid[i]) {
            colorRect(BRICK_W * i, 0, BRICK_W - 2, BRICK_H, 'blue');
          }
        }
      }

      function drawAll() {
        //  console.log(ballX)
        colorRect(0, 0, canvas.width, canvas.height, 'black');
        colorCircle(ballX, ballY, 10, 'yellow');
        colorRect(
          paddleX,
          canvas.height - PADDLE_DIST_FROM_EDGE,
          PADDLE_WIDTH,
          PADDLE_THICKNESS,
          'blue'
        );

        drawBricks();
        colorText(mouseX + ',' + mouseY, mouseX, mouseY, 'yellow');
      }

      function colorRect(topLeftX, topLeftY, boxWidth, boxHeight, fillcolor) {
        canvasContext.fillStyle = fillcolor;
        canvasContext.fillRect(topLeftX, topLeftY, boxWidth, boxHeight);
      }

      function colorText(showWords, textX, textY, fillcolor) {
        canvasContext.fillStyle = fillcolor;
        canvasContext.fillText(showWords, textX, textY);
      }
      function targetBrowserEnvironment() {
        console.log(
          'Width & inner Height',
          window.innerWidth,
          window.innerHeight
        );
        console.log('DPR & width ', window.devicePixelRatio, window.width);
      }
      function colorCircle(centerX, centerY, radius, fillcolor) {
        canvasContext.fillStyle = fillcolor;
        canvasContext.beginPath();
        canvasContext.arc(centerX, centerY, radius, 0, Math.PI * 2, true);
        canvasContext.fill();
      }
      console.log('text from the script');
    </script>
  </body>
</html>
